# 株式会社ティーシー 業務管理システム 操作マニュアル

## 目次

1. [はじめに](#はじめに)
2. [システム要件](#システム要件)
3. [ログイン](#ログイン)
4. [メイン画面](#メイン画面)
5. [取引先マスター管理](#取引先マスター管理)
6. [作業員マスター管理](#作業員マスター管理)
7. [サービスマスター管理](#サービスマスター管理)
8. [案件管理](#案件管理)
9. [業務指示書管理](#業務指示書管理)
10. [統計情報](#統計情報)
11. [トラブルシューティング](#トラブルシューティング)

## はじめに

このマニュアルは、株式会社ティーシーの業務管理システムの操作方法を説明します。本システムは配管事業のための統合管理ツールで、取引先や作業員の管理、案件の登録・管理、業務指示書の作成、各種統計情報の表示などの機能を備えています。

## システム要件

- **OS**: Windows 10/11
- **メモリ**: 4GB以上推奨
- **ディスク容量**: 200MB以上の空き容量
- **必要なソフトウェア**: .exe版を使用する場合は不要。ソースコードから実行する場合はPython 3.8以上とrequirements.txtに記載の各種パッケージが必要。

## ログイン

1. アプリケーションを起動すると、ログイン画面が表示されます。
2. ユーザーIDとパスワードを入力してください。
   - 初期設定の管理者アカウント: ID `0001` パスワード `001`
   - 一般ユーザーアカウント: ID `0002`〜`0005` パスワード `002`〜`005`
3. 「ログイン」ボタンをクリックします。

![ログイン画面](resources/images/login_screen.png)

**注意**: セキュリティのため、運用開始前に初期パスワードを変更することを強く推奨します。

## メイン画面

ログイン後、メイン画面が表示されます。画面上部にタブが配置されており、各タブをクリックすることで機能を切り替えることができます。

- **取引先**: 取引先情報の管理
- **作業員**: 作業員情報の管理
- **サービス**: サービス項目の管理
- **案件管理**: 案件の登録・管理
- **業務指示書**: 業務指示書の作成・管理
- **統計情報**: 各種統計データの表示（管理者のみ）

## 取引先マスター管理

取引先の情報を登録・管理するための画面です。

### 取引先一覧の表示

「取引先」タブをクリックすると、登録されている取引先の一覧が表示されます。

### 取引先の検索

画面上部の検索バーに検索したい取引先名を入力し、「検索」ボタンをクリックすると、該当する取引先が表示されます。

### 取引先の追加

1. 「追加」ボタンをクリックします。
2. 表示されたダイアログに以下の情報を入力します：
   - 取引先名（必須）
   - 住所
   - 電話番号
   - メールアドレス
   - 備考
   - 図面あり（チェックボックス）
   - 書類あり（チェックボックス）
3. 「OK」ボタンをクリックして保存します。

### 取引先の編集

1. 編集したい取引先を一覧から選択します。
2. 「編集」ボタンをクリックします。
3. 表示されたダイアログで情報を編集します。
4. 「OK」ボタンをクリックして変更を保存します。

### 取引先の削除

1. 削除したい取引先を一覧から選択します。
2. 「削除」ボタンをクリックします。
3. 確認ダイアログが表示されるので、「はい」をクリックして削除を実行します。

**注意**: 案件に関連付けられている取引先を削除する場合は、慎重に行ってください。

## 作業員マスター管理

作業員の情報を登録・管理するための画面です。

### 作業員一覧の表示

「作業員」タブをクリックすると、登録されている作業員の一覧が表示されます。

### 作業員の検索

画面上部の検索バーに検索したい作業員名を入力し、「検索」ボタンをクリックすると、該当する作業員が表示されます。

### 作業員の追加

1. 「追加」ボタンをクリックします。
2. 表示されたダイアログに以下の情報を入力します：
   - 作業員名（必須）
   - 住所
   - 電話番号
   - メールアドレス
   - マイナンバー
   - 血液型
   - 緊急連絡先（氏名）
   - 緊急連絡先（電話番号）
   - 備考
3. 「OK」ボタンをクリックして保存します。

### 作業員の編集

1. 編集したい作業員を一覧から選択します。
2. 「編集」ボタンをクリックします。
3. 表示されたダイアログで情報を編集します。
4. 「OK」ボタンをクリックして変更を保存します。

### 作業員の削除

1. 削除したい作業員を一覧から選択します。
2. 「削除」ボタンをクリックします。
3. 確認ダイアログが表示されるので、「はい」をクリックして削除を実行します。

**注意**: 案件に関連付けられている作業員を削除する場合は、慎重に行ってください。関連するデータも影響を受ける可能性があります。

## サービスマスター管理

提供するサービス項目を登録・管理するための画面です。

### サービス一覧の表示

「サービス」タブをクリックすると、登録されているサービスの一覧が表示されます。

### サービスの検索

画面上部の検索バーに検索したいサービス名を入力し、「検索」ボタンをクリックすると、該当するサービスが表示されます。

### サービスの追加

1. 「追加」ボタンをクリックします。
2. 表示されたダイアログに以下の情報を入力します：
   - サービス名（必須）
   - 説明
3. 「OK」ボタンをクリックして保存します。

### サービスの編集

1. 編集したいサービスを一覧から選択します。
2. 「編集」ボタンをクリックします。
3. 表示されたダイアログで情報を編集します。
4. 「OK」ボタンをクリックして変更を保存します。

### サービスの削除

1. 削除したいサービスを一覧から選択します。
2. 「削除」ボタンをクリックします。
3. 確認ダイアログが表示されるので、「はい」をクリックして削除を実行します。

**注意**: 案件に関連付けられているサービスを削除する場合は、慎重に行ってください。

## 案件管理

案件情報を登録・管理するための画面です。

### 案件一覧の表示

「案件管理」タブをクリックすると、登録されている案件の一覧が表示されます。

### 案件の検索・絞り込み

画面上部の各種フィルタを使用して案件を絞り込むことができます：

- **検索バー**: 案件タイトルで検索
- **状態フィルタ**: 作業前、作業中、完了、キャンセルで絞り込み
- **取引先フィルタ**: 特定の取引先の案件で絞り込み
- **サービスフィルタ**: 特定のサービスの案件で絞り込み
- **並び替え**: 登録日、価格、案件名などで並び替え
- **期間**: 年や月で絞り込み

各フィルタを設定後、一覧に反映されます。

### 案件の追加

1. 「追加」ボタンをクリックします。
2. 表示されたダイアログに以下の情報を入力します：
   - 案件タイトル（必須）
   - 取引先（必須）
   - サービス（必須）
   - 現場住所（必須）
   - 価格（必須）
   - 人件費
   - 作業期間（開始日・終了日）
   - 状態
   - 完了日
   - トラブルあり（チェックボックスと担当者）
   - 説明
   - 担当作業員（複数選択可能）
3. 「OK」ボタンをクリックして保存します。

### 案件の編集

1. 編集したい案件を一覧から選択します。
2. 「編集」ボタンをクリックします。
3. 表示されたダイアログで情報を編集します。
4. 「OK」ボタンをクリックして変更を保存します。

#### 案件の写真管理

案件編集画面では、案件に関連する写真を管理することもできます：

1. 「写真追加」ボタンをクリックして写真を選択します。
2. 「写真表示」ボタンをクリックすると、登録されている写真が表示されます。
3. 写真ビューアでは以下の操作が可能です：
   - 写真の閲覧（前の写真/次の写真）
   - 写真の削除
   - 写真のエクスポート（任意のフォルダに保存）

### 案件の削除

1. 削除したい案件を一覧から選択します。
2. 「削除」ボタンをクリックします。
3. 確認ダイアログが表示されるので、「はい」をクリックして削除を実行します。

## 業務指示書管理

業務指示書を作成・管理するための画面です。

### 業務指示書の作成

業務指示書は2つの方法で作成できます：

#### 1. 案件から作成する場合
1. 「案件管理」タブで案件を選択して「編集」をクリックします。
2. 案件編集画面で「業務指示書」ボタンをクリックします。
3. 表示された業務指示書ダイアログに必要情報を入力します。案件情報から自動的に一部の情報が入力されます。

#### 2. 業務指示書タブから直接作成する場合
1. 「業務指示書」タブをクリックします。
2. 「追加」ボタンをクリックします。
3. 「新規作成」または「既存案件から作成」を選択します。
4. 「既存案件から作成」を選んだ場合は、案件を選択します。
5. 業務指示書ダイアログに必要情報を入力します。

### 業務指示書の編集

1. 「業務指示書」タブで編集したい業務指示書を選択します。
2. 「編集」ボタンをクリックします。
3. 表示されたダイアログで情報を編集します。
4. 「DB保存」ボタンをクリックして変更を保存します。

### 業務指示書のプレビュー・PDF保存・印刷

業務指示書ダイアログでは、以下の操作が可能です：

- **プレビュー**: 「プレビュー」ボタンをクリックすると、業務指示書のプレビューが表示されます。
- **PDF保存**: 「PDF保存」ボタンをクリックすると、業務指示書をPDFファイルとして保存できます。
- **印刷**: 「印刷」ボタンをクリックすると、業務指示書を印刷できます。
- **DB保存**: 「DB保存」ボタンをクリックすると、業務指示書の内容をデータベースに保存できます。

### 業務指示書の削除

1. 「業務指示書」タブで削除したい業務指示書を選択します。
2. 「削除」ボタンをクリックします。
3. 確認ダイアログが表示されるので、「はい」をクリックして削除を実行します。

## 統計情報

統計情報を表示するための画面です。※管理者権限を持つユーザーのみアクセス可能です。

「統計情報」タブには以下の4つのサブタブがあります：

### 前年度比較

月別の売上を前年度と比較するグラフを表示します。

1. 「前年度比較」タブを選択します。
2. 画面上部のコントロールで以下の設定が可能です：
   - **対象年度**: 比較の主となる年度を選択
   - **比較年度**: 比較対象となる年度を選択
   - **売上目標**: 目標金額を設定（グラフに赤線で表示）
3. 設定を変更すると、グラフが自動的に更新されます。
4. グラフは対象年度（実線）と比較年度（点線）の月別売上と、月間目標（赤線）を表示します。

### トラブル統計

作業員別・取引先別のトラブル率を表示します。

1. 「トラブル統計」タブを選択します。
2. 画面上部の「表示年度」で対象年度を選択します。
3. 以下の2つのサブタブで情報を確認できます：
   - **作業員別トラブル率**: 作業員ごとのトラブル件数、担当案件数、トラブル率を表示
   - **取引先別トラブル率**: 取引先ごとのトラブル件数、案件数、トラブル率を表示
4. 各列の見出しをクリックすると、その列で並び替えができます。

### 価格統計

案件価格に関する統計情報を表示します。

1. 「価格統計」タブを選択します。
2. 画面上部の「表示年度」で対象年度を選択します。
3. 以下の統計情報が表示されます：
   - **平均単価**: 案件の平均価格
   - **最小単価**: 最も安い案件の価格
   - **最大単価**: 最も高い案件の価格
   - **合計金額**: 全案件の合計金額
   - **案件数**: 対象年度の案件総数

### サービス別売上

サービスごとの売上金額を棒グラフで表示します。

1. 「サービス別売上」タブを選択します。
2. 画面上部の「表示年度」で対象年度を選択します。
3. 各サービスの売上金額が棒グラフで表示されます。
4. グラフの各バーには金額が表示されます。

## トラブルシューティング

### ログインできない

- ユーザーIDとパスワードが正しいか確認してください。
- 大文字・小文字や全角・半角が正しいか確認してください。
- メンテナンスモードのバックアップログインを試す場合は、ID「admin」パスワード「tcadmin」でログインしてください。

### 統計タブが表示されない

- 統計タブは管理者権限（admin）を持つユーザーのみ表示されます。一般ユーザー（user）では表示されません。

### PDF出力時にエラーが発生する

- IPAexフォントが正しくインストールされているか確認してください。
- フォントファイル（ipaexg.ttf）がプロジェクトの`fonts`ディレクトリに配置されているか確認してください。

### 画面が正しく表示されない

- アプリケーションを再起動してみてください。
- ディスプレイの解像度が1280x720以上であることを確認してください。

### データが正しく保存されない

- 入力項目が正しく入力されているか確認してください（必須項目など）。
- データベースが破損している可能性があります。サポートに連絡してください。

### その他の問題

問題が解決しない場合は、株式会社ティーシーのサポート担当にお問い合わせください。 