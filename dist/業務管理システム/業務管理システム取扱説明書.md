# 株式会社ティーシー 業務管理システム EXEファイル取扱説明書

## 目次
1. [はじめに](#はじめに)
2. [システム概要](#システム概要)
3. [セットアップ方法](#セットアップ方法)
4. [単独使用時の操作方法](#単独使用時の操作方法)
5. [複数人での共有使用](#複数人での共有使用)
6. [OneDriveを活用した共有方法](#oneDriveを活用した共有方法)
7. [ユーザー権限について](#ユーザー権限について)
8. [基本操作説明](#基本操作説明)
9. [注意事項・制限事項](#注意事項制限事項)
10. [トラブルシューティング](#トラブルシューティング)
11. [お問い合わせ](#お問い合わせ)

---

## はじめに

このマニュアルは、株式会社ティーシーの業務管理システム（EXEファイル版）の取扱説明書です。本システムは配管事業の業務管理を効率化するために開発されたデスクトップアプリケーションです。

**重要**: このシステムはローカル環境での使用を前提として設計されており、同じデータベースファイルを複数人が同時に開くことはできません。複数人での使用時は特別な手順が必要です。

---

## システム概要

### 主な機能
- 取引先マスター管理
- 作業員マスター管理
- サービスマスター管理
- 案件登録・管理
- 業務指示書作成・印刷
- 統計情報表示（売上目標設定、前年度比較、トラブル統計など）
- 写真管理機能

### 対応OS
- Windows 10 / 11

### 必要な環境
- メモリ: 4GB以上推奨
- ディスク容量: 200MB以上の空き容量

---

## セットアップ方法

### 1. 初回セットアップ
1. 配布されたフォルダ（`dist`フォルダ）を適切な場所にコピーします
   - 推奨場所: `C:\Program Files\TC業務管理システム\`
   - または: `C:\Users\[ユーザー名]\Documents\TC業務管理システム\`

2. フォルダ内に以下のファイルが含まれていることを確認してください：
   - `TC業務管理システム.exe` (実行ファイル)
   - `tc_management.db` (データベースファイル)
   - `resources` フォルダ (画像、アイコン等)
   - `fonts` フォルダ (フォントファイル)

3. `TC業務管理システム.exe`をダブルクリックして起動します

### 2. 初回ログイン
初期設定のユーザー情報でログインしてください：

**管理者アカウント**
- ID: `0001`
- パスワード: `0526`
- 権限: マスター権限（全機能アクセス可能）

**一般ユーザーアカウント**
- ID: `0002`
- パスワード: `002`
- 権限: 案件管理・指示書作成機能のみ

---

## 単独使用時の操作方法

### 基本的な使用手順
1. EXEファイルを起動
2. ユーザーIDとパスワードを入力してログイン
3. 各タブで業務を実行
4. データは自動的にローカルのデータベースファイルに保存
5. 使用終了時はアプリケーションを閉じる

### データの保存場所
- データベースファイル: `tc_management.db`
- 写真ファイル: `resources\project_photos\[案件ID]\`
- 図面・書類: `resources\client_files\`

---

## 複数人での共有使用

### ⚠️ 重要な制限事項
**このシステムは同時に複数人が使用することはできません。**以下の制限があります：

1. **同時アクセス不可**: SQLiteデータベースの制限により、複数人が同じデータベースファイルを同時に開くとデータが破損する可能性があります
2. **排他制御なし**: ユーザー間でのデータ競合を防ぐ機能はありません
3. **リアルタイム同期なし**: 一人が更新したデータは、他の人が再起動するまで反映されません

### 複数人使用時の推奨運用方法

#### 方法1: 時間分割使用
1. 使用者を時間帯別に分ける（例：午前中はAさん、午後はBさん）
2. 使用開始前に他の人がアプリケーションを閉じていることを確認
3. 使用後は必ずアプリケーションを完全に終了

#### 方法2: 担当者分割
1. 機能別に担当者を決める
   - マスター管理担当者
   - 案件入力担当者
   - 指示書作成担当者
2. 各担当者は決められた時間にのみアクセス

#### 方法3: 日別ローテーション
1. 日単位で担当者を決める
2. その日の担当者のみがシステムを使用
3. 翌日の担当者に引き継ぎを行う

---

## OneDriveを活用した共有方法

OneDriveを使用することで、複数人でデータを共有しながら安全に運用できます。

### 1. OneDriveセットアップ手順

#### 管理者側（初期設定）
1. OneDriveアカウントにログイン
2. OneDrive上に共有フォルダを作成（例：`TC業務管理システム共有`）
3. システムフォルダ全体をOneDriveフォルダにコピー
4. フォルダを利用者全員と共有

#### 利用者側（初期設定）
1. 共有されたOneDriveフォルダにアクセス
2. フォルダを自分のOneDriveに追加
3. OneDriveの同期設定を確認（自動同期をONにする）
4. ローカルの同期フォルダからシステムを起動

### 2. OneDrive使用時の運用ルール

#### 開始前の確認事項
```
□ 他の利用者がシステムを使用していないことをチャット等で確認
□ OneDriveの同期が完了していることを確認
□ データベースファイルが最新版であることを確認
```

#### 使用中の注意事項
- **必ず一人ずつ使用する**
- 使用開始時に他の利用者に連絡
- 長時間使用する場合は事前に連絡
- 重要な作業前はデータベースをバックアップ

#### 終了時の手順
```
1. アプリケーションを完全に終了
2. OneDriveの同期が完了するまで待機（数分程度）
3. 使用終了を他の利用者に連絡
4. 必要に応じて作業内容を共有
```

### 3. OneDrive共有の利点
- **自動バックアップ**: データが自動的にクラウドに保存
- **バージョン履歴**: OneDriveの履歴機能でデータを復元可能
- **どこからでもアクセス**: インターネット接続があればどこからでも利用可能
- **自動同期**: 変更内容が自動的に他の利用者に反映

### 4. OneDrive使用時のトラブル対策
- **同期エラー**: OneDriveを一度停止して再起動
- **競合ファイル**: 複数の競合ファイルがある場合は最新のものを選択
- **接続エラー**: インターネット接続を確認

---

## ユーザー権限について

### 管理者権限（ID: 0001）
**アクセス可能な機能:**
- 取引先マスター管理
- 作業員マスター管理
- サービスマスター管理
- 案件管理
- 業務指示書作成・管理
- 統計情報（全機能）

### 一般ユーザー権限（ID: 0002）
**アクセス可能な機能:**
- 案件管理
- 業務指示書作成・管理

**アクセス制限:**
- マスター管理機能は利用不可
- 統計情報タブは表示されない

### セキュリティ推奨事項
1. 初期パスワードは必ず変更してください
2. 定期的にパスワードを変更してください
3. ユーザーIDとパスワードは厳重に管理してください

---

## 基本操作説明

### ログイン手順
1. アプリケーションを起動
2. ユーザーIDを入力
3. パスワードを入力
4. 「ログイン」ボタンをクリック

### メイン画面の構成
- **タブ**: 機能別にタブで切り替え
- **フィルタエリア**: 検索・絞り込み機能
- **データ一覧**: 登録データの表示
- **操作ボタン**: 追加・編集・削除ボタン

### データ入力の基本
1. 「追加」ボタンをクリック
2. 必須項目（赤字表示）を入力
3. その他の項目を必要に応じて入力
4. 「OK」ボタンで保存

### データ編集の基本
1. 編集したいデータを一覧から選択
2. 「編集」ボタンをクリック
3. 内容を修正
4. 「OK」ボタンで保存

### 業務指示書作成手順
1. 案件管理から対象案件を選択
2. 「編集」をクリック
3. 案件編集画面で「業務指示書」ボタンをクリック
4. 必要事項を入力
5. 「プレビュー」で内容確認
6. 「PDF保存」または「印刷」で出力
7. 「DB保存」でデータベースに保存

### 統計情報の確認（管理者のみ）
1. 「統計情報」タブをクリック
2. 見たい統計のサブタブを選択
   - **売上目標設定**: 年間・月別の売上目標を設定
   - **前年度比較**: 年度別の売上比較グラフ
   - **トラブル統計**: 作業員・取引先別のトラブル率
   - **価格統計**: 平均単価、最大・最小価格など
   - **サービス別売上**: サービスごとの売上グラフ
3. 年度を選択してデータを表示

---

## 注意事項・制限事項

### データベース関連
- **同時アクセス禁止**: 複数人で同時にアプリケーションを開かない
- **バックアップ推奨**: 重要なデータは定期的にバックアップ
- **ファイル移動注意**: データベースファイルの場所を変更しない

### 写真・ファイル管理
- **対応形式**: JPG、PNG、GIF形式の画像
- **ファイルサイズ**: 1ファイル10MB以下推奨
- **保存場所**: resourcesフォルダ内に自動保存

### PDF出力関連
- **フォント**: 日本語フォント（IPAexゴシック）が必要
- **出力先**: デスクトップまたは指定フォルダ
- **印刷**: システム標準プリンタを使用

### ネットワーク環境
- **ネットワーク共有**: ネットワークドライブでの使用は非推奨
- **OneDrive**: OneDriveでの共有は推奨
- **クラウドストレージ**: リアルタイム同期するストレージでの使用は注意

---

## トラブルシューティング

### よくある問題と解決方法

#### 1. アプリケーションが起動しない
**症状**: EXEファイルをダブルクリックしても何も起こらない
**解決方法**:
- Windowsのセキュリティ設定を確認
- ファイルの実行権限を確認
- ウイルス対策ソフトの除外設定に追加
- 管理者権限で実行してみる

#### 2. ログインできない
**症状**: 正しいIDとパスワードを入力してもログインできない
**解決方法**:
- 入力文字の確認（全角・半角、大文字・小文字）
- Caps Lockの状態を確認
- 初期パスワードで再度試行
- データベースファイルの存在を確認

#### 3. データが保存されない
**症状**: 入力したデータが次回起動時に消えている
**解決方法**:
- ファイルの書き込み権限を確認
- 十分なディスク容量があるか確認
- ウイルス対策ソフトの設定を確認
- 管理者権限でアプリケーションを実行

#### 4. PDF出力ができない
**症状**: PDF保存ボタンを押してもエラーが発生する
**解決方法**:
- フォントファイル（ipaexg.ttf）の存在を確認
- 出力先フォルダの書き込み権限を確認
- 十分なディスク容量があるか確認

#### 5. 統計情報が表示されない
**症状**: 統計情報タブが表示されない
**解決方法**:
- 管理者権限でログインしているか確認
- ユーザーID「0001」でログインしているか確認

#### 6. OneDrive同期でエラーが発生
**症状**: OneDriveで同期エラーや競合が発生
**解決方法**:
- 他のユーザーがアプリケーションを終了しているか確認
- OneDriveアプリケーションを再起動
- 競合ファイルがある場合は最新のファイルを選択
- インターネット接続を確認

#### 7. 写真が表示されない
**症状**: 追加した写真が表示されない
**解決方法**:
- 写真ファイルが破損していないか確認
- 対応形式（JPG、PNG、GIF）かを確認
- ファイルサイズが適切かを確認
- resourcesフォルダの存在を確認

### 緊急時の対応

#### データベースバックアップからの復元
1. アプリケーションを完全に終了
2. 現在の`tc_management.db`ファイルを別名で保存
3. バックアップファイルを`tc_management.db`にリネーム
4. アプリケーションを再起動

#### システムの完全リセット
1. アプリケーションを終了
2. `tc_management.db`ファイルを削除（重要: データが全て失われます）
3. アプリケーションを再起動（新しいデータベースが作成されます）
4. 初期ユーザーでログイン可能になります

---

## お問い合わせ

### サポート対象
- アプリケーションの基本的な使用方法
- エラーの解決方法
- データのバックアップ・復元
- OneDriveでの共有設定

### お問い合わせ先
**株式会社ティーシー システム管理担当**
- 電話: [お問い合わせ先電話番号]
- メール: [お問い合わせ先メールアドレス]
- 受付時間: 平日 9:00-17:00

### お問い合わせ時に必要な情報
1. 使用しているOSのバージョン
2. 発生している問題の詳細
3. エラーメッセージ（ある場合）
4. 問題が発生する直前の操作
5. 使用しているユーザーID（パスワードは不要）

---

## 付録

### システム仕様詳細
- **データベース**: SQLite
- **対応画像形式**: JPG、PNG、GIF
- **PDF出力**: ReportLabライブラリ使用
- **文字コード**: UTF-8

### 推奨システム要件
- **OS**: Windows 10 Version 1903 以降 / Windows 11
- **CPU**: 1GHz以上
- **メモリ**: 4GB以上
- **ディスク**: 500MB以上の空き容量
- **画面解像度**: 1280x720以上

### 制限事項一覧
- 同時ユーザー数: 1人のみ
- 最大案件数: 制限なし（ただし、パフォーマンスに影響する可能性）
- 最大写真数: 1案件あたり100枚程度推奨
- ファイルサイズ: 1写真あたり10MB以下推奨

---

**© 2025 株式会社ティーシー - 本マニュアルの無断転載・複製を禁じます** 